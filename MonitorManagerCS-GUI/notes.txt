Completely overhauling this program now.

